<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.3">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px Times; -webkit-text-stroke: #000000; min-height: 14.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!doctype html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="en"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">  &lt;meta charset="utf-8" /&gt;</span></p>
<p class="p1"><span class="s1">  &lt;title&gt;Club Match Generator — Ad‑free &amp; Offline&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">  &lt;meta name="viewport" content="width=device-width, initial-scale=1" /&gt;</span></p>
<p class="p1"><span class="s1">  &lt;style&gt;</span></p>
<p class="p1"><span class="s1">    :root{</span></p>
<p class="p1"><span class="s1">      --bg:#0f1420; --panel:#151c2c; --ink:#e8eefb; --muted:#a8b3c7;</span></p>
<p class="p1"><span class="s1">      --accent:#4cc2ff; --accent2:#6fff93; --danger:#ff6b6b; --warn:#ffd166;</span></p>
<p class="p1"><span class="s1">      --line:#223049; --pill:#0e1930;</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p1"><span class="s1">    *{box-sizing:border-box}</span></p>
<p class="p1"><span class="s1">    body{</span></p>
<p class="p1"><span class="s1">      margin:0; font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,'Helvetica Neue',Arial;</span></p>
<p class="p1"><span class="s1">      background:linear-gradient(180deg,#0b1020,#0f1420 30%,#0b1020); color:var(--ink);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p1"><span class="s1">    header{</span></p>
<p class="p1"><span class="s1">      padding:14px 16px; border-bottom:1px solid var(--line);</span></p>
<p class="p1"><span class="s1">      position:sticky; top:0; backdrop-filter: blur(6px);</span></p>
<p class="p1"><span class="s1">      background:linear-gradient(180deg,rgba(21,28,44,.92),rgba(21,28,44,.6));</span></p>
<p class="p1"><span class="s1">      display:flex; align-items:center; gap:12px; z-index:5;</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p1"><span class="s1">    header h1{font-size:18px;margin:0}</span></p>
<p class="p1"><span class="s1">    header small{color:var(--muted)}</span></p>
<p class="p1"><span class="s1">    .spacer{flex:1}</span></p>
<p class="p1"><span class="s1">    main{max-width:1200px;margin:16px auto 80px;padding:0 16px}</span></p>
<p class="p1"><span class="s1">    .grid{display:grid; gap:16px}</span></p>
<p class="p1"><span class="s1">    @media(min-width:1020px){ .grid-3{grid-template-columns: 340px 1fr 1fr} }</span></p>
<p class="p1"><span class="s1">    @media(min-width:1020px){ .grid-2{grid-template-columns: 420px 1fr} }</span></p>
<p class="p1"><span class="s1">    section.panel{background:var(--panel); border:1px solid var(--line); border-radius:12px; padding:14px}</span></p>
<p class="p1"><span class="s1">    h2{margin:.2rem 0 10px;font-size:16px}</span></p>
<p class="p1"><span class="s1">    .muted{color:var(--muted); font-size:13px}</span></p>
<p class="p1"><span class="s1">    .hr{height:1px;background:var(--line);margin:10px 0}</span></p>
<p class="p1"><span class="s1">    label{display:block; font-size:13px; color:var(--muted); margin:8px 0 6px}</span></p>
<p class="p1"><span class="s1">    input[type=text], input[type=number], select{</span></p>
<p class="p1"><span class="s1">      width:100%; padding:10px 12px; border-radius:10px; border:1px solid var(--line);</span></p>
<p class="p1"><span class="s1">      background:#0c1422; color:var(--ink);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p1"><span class="s1">    .row{display:flex; gap:8px; align-items:center; flex-wrap:wrap}</span></p>
<p class="p1"><span class="s1">    .pill{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; background:var(--pill);</span></p>
<p class="p1"><span class="s1">      border:1px solid var(--line); border-radius:999px; color:var(--ink)}</span></p>
<p class="p1"><span class="s1">    .tag{background:#10203a;border:1px solid var(--line);padding:4px 8px;border-radius:999px;font-size:12px;color:var(--muted)}</span></p>
<p class="p1"><span class="s1">    button{</span></p>
<p class="p1"><span class="s1">      background:#192744; color:var(--ink); border:1px solid var(--line);</span></p>
<p class="p1"><span class="s1">      border-radius:10px; padding:10px 12px; cursor:pointer; font-weight:600;</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p1"><span class="s1">    button.primary{ background:linear-gradient(180deg,var(--accent),#2fa7ff); color:#001120; border:0 }</span></p>
<p class="p1"><span class="s1">    button.ghost{ background:transparent }</span></p>
<p class="p1"><span class="s1">    button.warn{ background:var(--warn); color:#222; border:0 }</span></p>
<p class="p1"><span class="s1">    button.danger{ background:var(--danger); color:#fff; border:0 }</span></p>
<p class="p1"><span class="s1">    ul.clean{list-style:none; padding:0; margin:0}</span></p>
<p class="p1"><span class="s1">    .team-pill{display:inline-flex; align-items:center; gap:8px; padding:8px 10px; background:var(--pill);</span></p>
<p class="p1"><span class="s1">      border:1px solid var(--line); border-radius:999px; margin:4px}</span></p>
<p class="p1"><span class="s1">    .team-pill button{padding:6px 8px}</span></p>
<p class="p1"><span class="s1">    table{width:100%; border-collapse:collapse}</span></p>
<p class="p1"><span class="s1">    th,td{border-bottom:1px solid var(--line); padding:8px 6px; font-size:14px; text-align:left}</span></p>
<p class="p1"><span class="s1">    th{color:var(--muted)}</span></p>
<p class="p1"><span class="s1">    td input[type=number]{width:70px; padding:6px 8px; border-radius:8px; border:1px solid var(--line); background:#0c1422; color:var(--ink)}</span></p>
<p class="p1"><span class="s1">    .small{font-size:12px; color:var(--muted)}</span></p>
<p class="p1"><span class="s1">    .badgel{padding:2px 6px;border-radius:6px;background:#11203a;border:1px solid var(--line);font-size:12px;color:var(--muted)}</span></p>
<p class="p1"><span class="s1">    .foot{position:fixed;left:0;right:0;bottom:0;background:linear-gradient(180deg,rgba(14,19,33,.1),rgba(14,19,33,.85) 25%);</span></p>
<p class="p1"><span class="s1">      backdrop-filter:blur(6px); border-top:1px solid var(--line); padding:10px 16px; display:flex; align-items:center; gap:8px; justify-content:center}</span></p>
<p class="p1"><span class="s1">    .ok{color:var(--accent2)} .warntext{color:var(--warn)} .err{color:var(--danger)} .mono{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;}</span></p>
<p class="p1"><span class="s1">  &lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p1"><span class="s1">  &lt;header&gt;</span></p>
<p class="p1"><span class="s1">    &lt;h1&gt;Club Match Generator&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1">    &lt;small&gt;Input → Courts/Time → Schedule → Score → Leaderboard&lt;/small&gt;</span></p>
<p class="p1"><span class="s1">    &lt;span class="spacer"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">    &lt;button id="exportBtn"&gt;Export JSON&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">    &lt;label for="importFile" class="pill" style="cursor:pointer"&gt;</span></p>
<p class="p1"><span class="s1">      &lt;span class="mono"&gt;Import JSON&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">      &lt;input id="importFile" type="file" accept="application/json" style="display:none"&gt;</span></p>
<p class="p1"><span class="s1">    &lt;/label&gt;</span></p>
<p class="p1"><span class="s1">    &lt;button class="ghost" id="resetBtn"&gt;Reset&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">  &lt;/header&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">  &lt;main class="grid grid-2"&gt;</span></p>
<p class="p1"><span class="s1">    &lt;!-- SETUP --&gt;</span></p>
<p class="p1"><span class="s1">    &lt;section class="panel"&gt;</span></p>
<p class="p1"><span class="s1">      &lt;h2&gt;Setup&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="muted"&gt;Add players, set courts &amp; time, pick Singles or Doubles, then generate.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="hr"&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      &lt;label&gt;Players&lt;/label&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div id="playerList"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="row" style="margin-top:8px"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;input id="playerInput" type="text" placeholder="Type name and press Enter; comma‑separated to add many" /&gt;</span></p>
<p class="p1"><span class="s1">        &lt;button id="addPlayerBtn"&gt;Add&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">      &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      &lt;div class="hr"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;label&gt;Match Options&lt;/label&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;div style="flex:1;min-width:120px"&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="small"&gt;Mode&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1">            &lt;label class="pill"&gt;&lt;input type="radio" name="mode" value="singles"&gt; Singles&lt;/label&gt;</span></p>
<p class="p1"><span class="s1">            &lt;label class="pill"&gt;&lt;input type="radio" name="mode" value="doubles" checked&gt; Doubles&lt;/label&gt;</span></p>
<p class="p1"><span class="s1">          &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">        &lt;div style="flex:1;min-width:120px"&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="small"&gt;Courts&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">          &lt;input id="courts" type="number" min="1" value="2"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">        &lt;div style="flex:1;min-width:120px"&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="small"&gt;Game duration (minutes)&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">          &lt;input id="gameMins" type="number" min="5" step="1" value="10"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">        &lt;div style="flex:1;min-width:140px"&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="small"&gt;Session length (minutes)&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">          &lt;input id="sessionMins" type="number" min="10" step="5" value="120"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="row" style="margin-top:8px"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;div style="flex:1;min-width:160px"&gt;</span></p>
<p class="p1"><span class="s1">          &lt;div class="small"&gt;Target total matches (optional)&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">          &lt;input id="targetMatches" type="number" min="1" step="1" placeholder="e.g., 24"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/div&gt;</span></p>
<p class="p1"><span class="s1">        &lt;span class="spacer"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">        &lt;span class="tag"&gt;Capacity per round: auto‑calculated&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">      &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      &lt;div class="hr"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1">        &lt;button class="primary" id="genBtn"&gt;Generate Schedule&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">        &lt;button id="clearBtn"&gt;Clear Schedule&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">        &lt;span id="msg" class="small"&gt;&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">      &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      &lt;div class="hr"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="small"&gt;Tip: If players &amp; courts don’t divide evenly, the app rotates **bench** time fairly.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">    &lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    &lt;!-- SCHEDULE &amp; SCOREBOARD --&gt;</span></p>
<p class="p1"><span class="s1">    &lt;section class="panel"&gt;</span></p>
<p class="p1"><span class="s1">      &lt;h2&gt;Schedule &amp; Scoreboard&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div id="scheduleEmpty" class="muted"&gt;No schedule yet. Click &lt;b&gt;Generate Schedule&lt;/b&gt;.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div id="scheduleWrap"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">    &lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    &lt;!-- LEADERBOARD --&gt;</span></p>
<p class="p1"><span class="s1">    &lt;section class="panel"&gt;</span></p>
<p class="p1"><span class="s1">      &lt;h2&gt;Leaderboard&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="muted"&gt;Ranks by &lt;b&gt;Wins&lt;/b&gt; → &lt;b&gt;Point Diff&lt;/b&gt; → &lt;b&gt;Points For&lt;/b&gt;. Updates as you enter scores.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div id="leaderboardWrap" style="margin-top:8px"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">    &lt;/section&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    &lt;!-- MATCH LOG --&gt;</span></p>
<p class="p1"><span class="s1">    &lt;section class="panel"&gt;</span></p>
<p class="p1"><span class="s1">      &lt;h2&gt;Match Log&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div class="muted"&gt;All matches with final scores.&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">      &lt;div id="logWrap" style="margin-top:8px"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">    &lt;/section&gt;</span></p>
<p class="p1"><span class="s1">  &lt;/main&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">  &lt;div class="foot"&gt;</span></p>
<p class="p1"><span class="s1">    &lt;span class="small"&gt;All data saved locally. Export anytime.&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">  &lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">  &lt;script&gt;</span></p>
<p class="p1"><span class="s1">    /* ========= Persistence ========= */</span></p>
<p class="p1"><span class="s1">    const LSKEY = 'club_matchgen_v2';</span></p>
<p class="p1"><span class="s1">    let S = load() || {</span></p>
<p class="p1"><span class="s1">      players: [],</span></p>
<p class="p1"><span class="s1">      settings: { mode:'doubles', courts:2, gameMins:10, sessionMins:120, targetMatches:'' },</span></p>
<p class="p1"><span class="s1">      rounds: [], // each round: [{id, round, court, teamA:[...], teamB:[...], scoreA:'', scoreB:'', done:false}]</span></p>
<p class="p1"><span class="s1">    };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function load(){ try{ return JSON.parse(localStorage.getItem(LSKEY)); }catch(e){ return null; } }</span></p>
<p class="p1"><span class="s1">    function save(){ localStorage.setItem(LSKEY, JSON.stringify(S)); }</span></p>
<p class="p1"><span class="s1">    function msg(text, cls='ok'){ const m=document.getElementById('msg'); m.textContent=text; m.className='small '+cls; if(text){ setTimeout(()=&gt;m.textContent='',2500);} }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= UI Elements ========= */</span></p>
<p class="p1"><span class="s1">    const elPlayerList = document.getElementById('playerList');</span></p>
<p class="p1"><span class="s1">    const elPlayerInput = document.getElementById('playerInput');</span></p>
<p class="p1"><span class="s1">    const elAddPlayerBtn = document.getElementById('addPlayerBtn');</span></p>
<p class="p1"><span class="s1">    const elCourts = document.getElementById('courts');</span></p>
<p class="p1"><span class="s1">    const elGameMins = document.getElementById('gameMins');</span></p>
<p class="p1"><span class="s1">    const elSessionMins = document.getElementById('sessionMins');</span></p>
<p class="p1"><span class="s1">    const elTargetMatches = document.getElementById('targetMatches');</span></p>
<p class="p1"><span class="s1">    const elScheduleEmpty = document.getElementById('scheduleEmpty');</span></p>
<p class="p1"><span class="s1">    const elScheduleWrap = document.getElementById('scheduleWrap');</span></p>
<p class="p1"><span class="s1">    const elLeaderboardWrap = document.getElementById('leaderboardWrap');</span></p>
<p class="p1"><span class="s1">    const elLogWrap = document.getElementById('logWrap');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= Helpers ========= */</span></p>
<p class="p1"><span class="s1">    const uid = ()=&gt; crypto.randomUUID();</span></p>
<p class="p1"><span class="s1">    const escapeHtml = s =&gt; String(s).replace(/[&amp;&lt;&gt;"']/g, m=&gt;({ '&amp;':'&amp;amp;','&lt;':'&amp;lt;','&gt;':'&amp;gt;','"':'&amp;quot;',"'":'&amp;#39;' }[m]));</span></p>
<p class="p1"><span class="s1">    const clone = x =&gt; JSON.parse(JSON.stringify(x));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function renderPlayers(){</span></p>
<p class="p1"><span class="s1">      elPlayerList.innerHTML = '';</span></p>
<p class="p1"><span class="s1">      const wrap = document.createElement('div');</span></p>
<p class="p1"><span class="s1">      S.players.forEach((p,i)=&gt;{</span></p>
<p class="p1"><span class="s1">        const pill = document.createElement('span');</span></p>
<p class="p1"><span class="s1">        pill.className='team-pill';</span></p>
<p class="p1"><span class="s1">        pill.innerHTML = `&lt;span&gt;${escapeHtml(p)}&lt;/span&gt;</span></p>
<p class="p1"><span class="s1">          &lt;button class="ghost" title="Rename"&gt;✎&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">          &lt;button class="danger" title="Remove"&gt;×&lt;/button&gt;`;</span></p>
<p class="p1"><span class="s1">        pill.querySelector('button.ghost').onclick = ()=&gt;{</span></p>
<p class="p1"><span class="s1">          const nn = prompt('Rename', p);</span></p>
<p class="p1"><span class="s1">          if(nn &amp;&amp; nn.trim()){ S.players[i]=nn.trim(); save(); renderPlayers(); }</span></p>
<p class="p1"><span class="s1">        };</span></p>
<p class="p1"><span class="s1">        pill.querySelector('button.danger').onclick = ()=&gt;{</span></p>
<p class="p1"><span class="s1">          if(confirm('Remove '+p+'?')){ S.players.splice(i,1); save(); renderPlayers(); }</span></p>
<p class="p1"><span class="s1">        };</span></p>
<p class="p1"><span class="s1">        wrap.appendChild(pill);</span></p>
<p class="p1"><span class="s1">      });</span></p>
<p class="p1"><span class="s1">      elPlayerList.appendChild(wrap);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= Scheduling ========= */</span></p>
<p class="p1"><span class="s1">    function settingsFromUI(){</span></p>
<p class="p1"><span class="s1">      const mode = document.querySelector('input[name=mode]:checked')?.value || 'doubles';</span></p>
<p class="p1"><span class="s1">      const courts = Math.max(1, parseInt(elCourts.value||'1',10));</span></p>
<p class="p1"><span class="s1">      const gameMins = Math.max(5, parseInt(elGameMins.value||'10',10));</span></p>
<p class="p1"><span class="s1">      const sessionMins = Math.max(10, parseInt(elSessionMins.value||'60',10));</span></p>
<p class="p1"><span class="s1">      const targetMatches = elTargetMatches.value ? Math.max(1, parseInt(elTargetMatches.value,10)) : '';</span></p>
<p class="p1"><span class="s1">      S.settings = {mode, courts, gameMins, sessionMins, targetMatches};</span></p>
<p class="p1"><span class="s1">      save();</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function calcRounds(){</span></p>
<p class="p1"><span class="s1">      const {courts, gameMins, sessionMins, targetMatches} = S.settings;</span></p>
<p class="p1"><span class="s1">      const byTime = Math.floor(sessionMins / gameMins);</span></p>
<p class="p1"><span class="s1">      if(targetMatches){</span></p>
<p class="p1"><span class="s1">        // matches per round equals number of courts (one match per court)</span></p>
<p class="p1"><span class="s1">        const byTarget = Math.ceil(targetMatches / courts);</span></p>
<p class="p1"><span class="s1">        return Math.min(Math.max(byTime,1), byTarget); // respect both time &amp; target</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p1"><span class="s1">      return Math.max(byTime, 1);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function genSchedule(){</span></p>
<p class="p1"><span class="s1">      if(S.players.length &lt; 2){ msg('Add at least 2 players', 'warntext'); return; }</span></p>
<p class="p1"><span class="s1">      settingsFromUI();</span></p>
<p class="p1"><span class="s1">      const { mode, courts } = S.settings;</span></p>
<p class="p1"><span class="s1">      const playersPerTeam = (mode==='singles') ? 1 : 2;</span></p>
<p class="p1"><span class="s1">      const playersPerCourt = playersPerTeam * 2; // two teams per court</span></p>
<p class="p1"><span class="s1">      const capacity = courts * playersPerCourt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      let roundsCount = calcRounds();</span></p>
<p class="p1"><span class="s1">      const queue = clone(S.players); // rotating queue</span></p>
<p class="p1"><span class="s1">      if(queue.length &lt; playersPerCourt){</span></p>
<p class="p1"><span class="s1">        msg('Not enough players for the selected mode', 'err'); return;</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      const rounds = [];</span></p>
<p class="p1"><span class="s1">      let offset = 0;</span></p>
<p class="p1"><span class="s1">      for(let r=1; r&lt;=roundsCount; r++){</span></p>
<p class="p1"><span class="s1">        // rotate queue by offset (fairness)</span></p>
<p class="p1"><span class="s1">        const rot = rotate(queue, offset++);</span></p>
<p class="p1"><span class="s1">        // pick active players for this round</span></p>
<p class="p1"><span class="s1">        const activeCount = Math.min(capacity, rot.length - (rot.length % playersPerTeam));</span></p>
<p class="p1"><span class="s1">        const active = rot.slice(0, activeCount);</span></p>
<p class="p1"><span class="s1">        // form teams</span></p>
<p class="p1"><span class="s1">        const teams = [];</span></p>
<p class="p1"><span class="s1">        for(let i=0;i&lt;active.length;i+=playersPerTeam){</span></p>
<p class="p1"><span class="s1">          teams.push(active.slice(i, i+playersPerTeam));</span></p>
<p class="p1"><span class="s1">        }</span></p>
<p class="p1"><span class="s1">        // pair teams into matches per court</span></p>
<p class="p1"><span class="s1">        const matches = [];</span></p>
<p class="p1"><span class="s1">        for(let t=0; t+1&lt;teams.length &amp;&amp; matches.length &lt; courts; t+=2){</span></p>
<p class="p1"><span class="s1">          matches.push({</span></p>
<p class="p1"><span class="s1">            id: uid(),</span></p>
<p class="p1"><span class="s1">            round: r,</span></p>
<p class="p1"><span class="s1">            court: matches.length+1,</span></p>
<p class="p1"><span class="s1">            teamA: teams[t],</span></p>
<p class="p1"><span class="s1">            teamB: teams[t+1],</span></p>
<p class="p1"><span class="s1">            scoreA:'', scoreB:'', done:false</span></p>
<p class="p1"><span class="s1">          });</span></p>
<p class="p1"><span class="s1">        }</span></p>
<p class="p1"><span class="s1">        rounds.push(matches);</span></p>
<p class="p1"><span class="s1">        // rotate players slightly differently each round to vary partners/opponents</span></p>
<p class="p1"><span class="s1">        queue.push(queue.shift());</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p1"><span class="s1">      S.rounds = rounds;</span></p>
<p class="p1"><span class="s1">      save();</span></p>
<p class="p1"><span class="s1">      renderAll();</span></p>
<p class="p1"><span class="s1">      msg('Schedule generated ✅');</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function rotate(arr, k){</span></p>
<p class="p1"><span class="s1">      const a = arr.slice();</span></p>
<p class="p1"><span class="s1">      const n = a.length; const s = ((k % n)+n)%n;</span></p>
<p class="p1"><span class="s1">      return a.slice(s).concat(a.slice(0,s));</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= Scoreboard &amp; Leaderboard ========= */</span></p>
<p class="p1"><span class="s1">    function onScoreInput(e){</span></p>
<p class="p1"><span class="s1">      const id = e.target.getAttribute('data-id');</span></p>
<p class="p1"><span class="s1">      const side = e.target.getAttribute('data-side'); // A or B</span></p>
<p class="p1"><span class="s1">      for(const round of S.rounds){</span></p>
<p class="p1"><span class="s1">        for(const m of round){</span></p>
<p class="p1"><span class="s1">          if(m.id===id){</span></p>
<p class="p1"><span class="s1">            if(side==='A') m.scoreA = e.target.value;</span></p>
<p class="p1"><span class="s1">            else m.scoreB = e.target.value;</span></p>
<p class="p1"><span class="s1">            const a = parseInt(m.scoreA,10), b = parseInt(m.scoreB,10);</span></p>
<p class="p1"><span class="s1">            m.done = Number.isInteger(a)&amp;&amp;Number.isInteger(b)&amp;&amp;a&gt;=0&amp;&amp;b&gt;=0&amp;&amp;m.scoreA!==''&amp;&amp;m.scoreB!=='';</span></p>
<p class="p1"><span class="s1">            save(); renderLeaderboard(); renderLog();</span></p>
<p class="p1"><span class="s1">            return;</span></p>
<p class="p1"><span class="s1">          }</span></p>
<p class="p1"><span class="s1">        }</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function computeLeaderboard(){</span></p>
<p class="p1"><span class="s1">      const stats = {}; // player -&gt; {P,W,L,PF,PA,PD,WinP}</span></p>
<p class="p1"><span class="s1">      S.players.forEach(p=&gt; stats[p] = {Player:p,P:0,W:0,L:0,PF:0,PA:0,PD:0,WinP:0});</span></p>
<p class="p1"><span class="s1">      for(const round of S.rounds){</span></p>
<p class="p1"><span class="s1">        for(const m of round){</span></p>
<p class="p1"><span class="s1">          if(!m.done) continue;</span></p>
<p class="p1"><span class="s1">          const a = parseInt(m.scoreA,10), b = parseInt(m.scoreB,10);</span></p>
<p class="p1"><span class="s1">          const teamA = m.teamA, teamB = m.teamB;</span></p>
<p class="p1"><span class="s1">          teamA.forEach(p=&gt;{ stats[p].P++; stats[p].PF+=a; stats[p].PA+=b; });</span></p>
<p class="p1"><span class="s1">          teamB.forEach(p=&gt;{ stats[p].P++; stats[p].PF+=b; stats[p].PA+=a; });</span></p>
<p class="p1"><span class="s1">          if(a&gt;b){ teamA.forEach(p=&gt;stats[p].W++); teamB.forEach(p=&gt;stats[p].L++); }</span></p>
<p class="p1"><span class="s1">          else if(b&gt;a){ teamB.forEach(p=&gt;stats[p].W++); teamA.forEach(p=&gt;stats[p].L++); }</span></p>
<p class="p1"><span class="s1">          else { /* draw not counted as win/loss by default */ }</span></p>
<p class="p1"><span class="s1">        }</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p1"><span class="s1">      Object.values(stats).forEach(s=&gt;{ s.PD = s.PF - s.PA; s.WinP = s.P ? (s.W/s.P) : 0; });</span></p>
<p class="p1"><span class="s1">      const rows = Object.values(stats).sort((x,y)=&gt;{</span></p>
<p class="p1"><span class="s1">        if(y.W!==x.W) return y.W-x.W;</span></p>
<p class="p1"><span class="s1">        if(y.PD!==x.PD) return y.PD-x.PD;</span></p>
<p class="p1"><span class="s1">        if(y.PF!==x.PF) return y.PF-x.PF;</span></p>
<p class="p1"><span class="s1">        return x.Player.localeCompare(y.Player);</span></p>
<p class="p1"><span class="s1">      });</span></p>
<p class="p1"><span class="s1">      return rows;</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= Rendering ========= */</span></p>
<p class="p1"><span class="s1">    function renderSchedule(){</span></p>
<p class="p1"><span class="s1">      elScheduleWrap.innerHTML = '';</span></p>
<p class="p1"><span class="s1">      const rounds = S.rounds;</span></p>
<p class="p1"><span class="s1">      elScheduleEmpty.style.display = rounds.length ? 'none' : 'block';</span></p>
<p class="p1"><span class="s1">      if(!rounds.length) return;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      rounds.forEach((matches, rIdx)=&gt;{</span></p>
<p class="p1"><span class="s1">        const h = document.createElement('h3');</span></p>
<p class="p1"><span class="s1">        h.textContent = `Round ${rIdx+1}`;</span></p>
<p class="p1"><span class="s1">        elScheduleWrap.appendChild(h);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">        const tbl = document.createElement('table');</span></p>
<p class="p1"><span class="s1">        tbl.innerHTML = `&lt;thead&gt;</span></p>
<p class="p1"><span class="s1">          &lt;tr&gt;&lt;th style="width:80px"&gt;Court&lt;/th&gt;&lt;th&gt;Team A&lt;/th&gt;&lt;th&gt;Team B&lt;/th&gt;&lt;th style="width:160px"&gt;Score&lt;/th&gt;&lt;th&gt;Status&lt;/th&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1">        &lt;/thead&gt;&lt;tbody&gt;&lt;/tbody&gt;`;</span></p>
<p class="p1"><span class="s1">        const tb = tbl.querySelector('tbody');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">        matches.forEach(m=&gt;{</span></p>
<p class="p1"><span class="s1">          const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1">          tr.innerHTML = `</span></p>
<p class="p1"><span class="s1">            &lt;td&gt;${m.court}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">            &lt;td&gt;${escapeHtml(m.teamA.join(' &amp; '))}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">            &lt;td&gt;${escapeHtml(m.teamB.join(' &amp; '))}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">            &lt;td&gt;</span></p>
<p class="p1"><span class="s1">              &lt;input type="number" min="0" step="1" value="${m.scoreA}" data-id="${m.id}" data-side="A"&gt; :</span></p>
<p class="p1"><span class="s1">              &lt;input type="number" min="0" step="1" value="${m.scoreB}" data-id="${m.id}" data-side="B"&gt;</span></p>
<p class="p1"><span class="s1">            &lt;/td&gt;</span></p>
<p class="p1"><span class="s1">            &lt;td&gt;&lt;span class="badgel"&gt;${m.done?'Final':'—'}&lt;/span&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">          `;</span></p>
<p class="p1"><span class="s1">          tb.appendChild(tr);</span></p>
<p class="p1"><span class="s1">        });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">        elScheduleWrap.appendChild(tbl);</span></p>
<p class="p1"><span class="s1">      });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      elScheduleWrap.querySelectorAll('input[type=number]').forEach(inp=&gt;{</span></p>
<p class="p1"><span class="s1">        inp.addEventListener('input', onScoreInput);</span></p>
<p class="p1"><span class="s1">      });</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function renderLeaderboard(){</span></p>
<p class="p1"><span class="s1">      elLeaderboardWrap.innerHTML='';</span></p>
<p class="p1"><span class="s1">      const rows = computeLeaderboard();</span></p>
<p class="p1"><span class="s1">      const tbl = document.createElement('table');</span></p>
<p class="p1"><span class="s1">      tbl.innerHTML = `&lt;thead&gt;</span></p>
<p class="p1"><span class="s1">        &lt;tr&gt;&lt;th&gt;#&lt;/th&gt;&lt;th&gt;Player&lt;/th&gt;&lt;th&gt;P&lt;/th&gt;&lt;th&gt;W&lt;/th&gt;&lt;th&gt;L&lt;/th&gt;&lt;th&gt;PF&lt;/th&gt;&lt;th&gt;PA&lt;/th&gt;&lt;th&gt;PD&lt;/th&gt;&lt;th&gt;Win%&lt;/th&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1">      &lt;/thead&gt;&lt;tbody&gt;&lt;/tbody&gt;`;</span></p>
<p class="p1"><span class="s1">      const tb = tbl.querySelector('tbody');</span></p>
<p class="p1"><span class="s1">      rows.forEach((r,i)=&gt;{</span></p>
<p class="p1"><span class="s1">        const tr = document.createElement('tr');</span></p>
<p class="p1"><span class="s1">        tr.innerHTML = `&lt;td&gt;${i+1}&lt;/td&gt;&lt;td&gt;${escapeHtml(r.Player)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">          &lt;td&gt;${r.P}&lt;/td&gt;&lt;td&gt;&lt;b&gt;${r.W}&lt;/b&gt;&lt;/td&gt;&lt;td&gt;${r.L}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1">          &lt;td&gt;${r.PF}&lt;/td&gt;&lt;td&gt;${r.PA}&lt;/td&gt;&lt;td&gt;${r.PD}&lt;/td&gt;&lt;td&gt;${(r.WinP*100).toFixed(0)}%&lt;/td&gt;`;</span></p>
<p class="p1"><span class="s1">        tb.appendChild(tr);</span></p>
<p class="p1"><span class="s1">      });</span></p>
<p class="p1"><span class="s1">      elLeaderboardWrap.appendChild(tbl);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function renderLog(){</span></p>
<p class="p1"><span class="s1">      elLogWrap.innerHTML = '';</span></p>
<p class="p1"><span class="s1">      const list = [];</span></p>
<p class="p1"><span class="s1">      for(const round of S.rounds){</span></p>
<p class="p1"><span class="s1">        for(const m of round){</span></p>
<p class="p1"><span class="s1">          if(m.done){</span></p>
<p class="p1"><span class="s1">            list.push(`R${m.round} C${m.court}: ${m.teamA.join(' &amp; ')} ${m.scoreA} – ${m.scoreB} ${m.teamB.join(' &amp; ')}`);</span></p>
<p class="p1"><span class="s1">          }</span></p>
<p class="p1"><span class="s1">        }</span></p>
<p class="p1"><span class="s1">      }</span></p>
<p class="p1"><span class="s1">      if(!list.length){ elLogWrap.innerHTML = '&lt;div class="muted"&gt;No completed matches yet.&lt;/div&gt;'; return; }</span></p>
<p class="p1"><span class="s1">      const ul = document.createElement('ul'); ul.className='clean';</span></p>
<p class="p1"><span class="s1">      list.forEach(line=&gt;{ const li=document.createElement('li'); li.textContent=line; ul.appendChild(li); });</span></p>
<p class="p1"><span class="s1">      elLogWrap.appendChild(ul);</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    function renderAll(){</span></p>
<p class="p1"><span class="s1">      // restore settings to UI</span></p>
<p class="p1"><span class="s1">      document.querySelectorAll('input[name=mode]').forEach(r=&gt; r.checked = (r.value===S.settings.mode));</span></p>
<p class="p1"><span class="s1">      elCourts.value = S.settings.courts;</span></p>
<p class="p1"><span class="s1">      elGameMins.value = S.settings.gameMins;</span></p>
<p class="p1"><span class="s1">      elSessionMins.value = S.settings.sessionMins;</span></p>
<p class="p1"><span class="s1">      elTargetMatches.value = S.settings.targetMatches||'';</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">      renderPlayers();</span></p>
<p class="p1"><span class="s1">      renderSchedule();</span></p>
<p class="p1"><span class="s1">      renderLeaderboard();</span></p>
<p class="p1"><span class="s1">      renderLog();</span></p>
<p class="p1"><span class="s1">    }</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    /* ========= Wire up ========= */</span></p>
<p class="p1"><span class="s1">    // players</span></p>
<p class="p1"><span class="s1">    elAddPlayerBtn.onclick = ()=&gt;{</span></p>
<p class="p1"><span class="s1">      const v = elPlayerInput.value.trim();</span></p>
<p class="p1"><span class="s1">      if(!v) return;</span></p>
<p class="p1"><span class="s1">      const parts = v.split(',').map(s=&gt;s.trim()).filter(Boolean);</span></p>
<p class="p1"><span class="s1">      S.players.push(...parts);</span></p>
<p class="p1"><span class="s1">      elPlayerInput.value=''; save(); renderPlayers();</span></p>
<p class="p1"><span class="s1">    };</span></p>
<p class="p1"><span class="s1">    elPlayerInput.addEventListener('keydown', e=&gt;{ if(e.key==='Enter'){ elAddPlayerBtn.click(); } });</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    // settings</span></p>
<p class="p1"><span class="s1">    document.querySelectorAll('input[name=mode]').forEach(r=&gt; r.addEventListener('change', ()=&gt;{ settingsFromUI(); }));</span></p>
<p class="p1"><span class="s1">    [elCourts, elGameMins, elSessionMins, elTargetMatches].forEach(inp=&gt; inp.addEventListener('input', settingsFromUI));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    // actions</span></p>
<p class="p1"><span class="s1">    document.getElementById('genBtn').onclick = genSchedule;</span></p>
<p class="p1"><span class="s1">    document.getElementById('clearBtn').onclick = ()=&gt;{ S.rounds=[]; save(); renderAll(); msg('Schedule cleared'); };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    // export / import / reset</span></p>
<p class="p1"><span class="s1">    document.getElementById('exportBtn').onclick = ()=&gt;{</span></p>
<p class="p1"><span class="s1">      const blob = new Blob([JSON.stringify(S,null,2)], {type:'application/json'});</span></p>
<p class="p1"><span class="s1">      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'club_matchgen.json'; a.click();</span></p>
<p class="p1"><span class="s1">    };</span></p>
<p class="p1"><span class="s1">    document.getElementById('importFile').onchange = async (e)=&gt;{</span></p>
<p class="p1"><span class="s1">      const file = e.target.files[0]; if(!file) return;</span></p>
<p class="p1"><span class="s1">      try{</span></p>
<p class="p1"><span class="s1">        const obj = JSON.parse(await file.text());</span></p>
<p class="p1"><span class="s1">        if(!('players' in obj) || !('rounds' in obj)) throw new Error('Invalid file');</span></p>
<p class="p1"><span class="s1">        S = obj; save(); renderAll(); msg('Imported successfully ✅');</span></p>
<p class="p1"><span class="s1">      }catch(err){ alert('Import failed: '+err.message); }</span></p>
<p class="p1"><span class="s1">      e.target.value='';</span></p>
<p class="p1"><span class="s1">    };</span></p>
<p class="p1"><span class="s1">    document.getElementById('resetBtn').onclick = ()=&gt;{</span></p>
<p class="p1"><span class="s1">      if(!confirm('This will clear all data. Proceed?')) return;</span></p>
<p class="p1"><span class="s1">      // safety export</span></p>
<p class="p1"><span class="s1">      const blob = new Blob([JSON.stringify(S,null,2)], {type:'application/json'});</span></p>
<p class="p1"><span class="s1">      const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download = 'club_matchgen_backup.json'; a.click();</span></p>
<p class="p1"><span class="s1">      S = { players:[], settings:{mode:'doubles',courts:2,gameMins:10,sessionMins:120,targetMatches:''}, rounds:[] };</span></p>
<p class="p1"><span class="s1">      save(); renderAll(); msg('Reset done');</span></p>
<p class="p1"><span class="s1">    };</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">    // init</span></p>
<p class="p1"><span class="s1">    renderAll();</span></p>
<p class="p1"><span class="s1">  &lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
<p class="p1"><span class="s1">``</span></p>
</body>
</html>
